<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>
    <!-- Actions -->
    <record id="action_custom_pr_all" model="ir.actions.act_window">
      <field name="name">All Purchase Requisitions</field>
      <field name="res_model">custom.pr</field>
      <field name="view_mode">tree,form</field>
    </record>
    <record id="action_custom_pr_standard" model="ir.actions.act_window">
      <field name="name">PR</field>
      <field name="res_model">custom.pr</field>
      <field name="view_mode">tree,form</field>
      <field name="domain">[('pr_type','=','standard')]</field>
      <field name="context">{'default_pr_type':'standard'}</field>
    </record>
    <record id="action_custom_pr_cash" model="ir.actions.act_window">
      <field name="name">Cash PR</field>
      <field name="res_model">custom.pr</field>
      <field name="view_mode">tree,form</field>
      <field name="domain">[('pr_type','=','cash')]</field>
      <field name="context">{'default_pr_type':'cash'}</field>
    </record>
    <!-- Menus -->
    <menuitem id="menu_custom_purchase_root"
              name="Custom Purchase"
              sequence="10"/>
    <menuitem id="menu_purchase_requisition"
              name="Purchase Requisition"
              parent="menu_custom_purchase_root"
              sequence="10"/>
    <menuitem id="menu_pr"
              name="PR"
              parent="menu_purchase_requisition"
              action="action_custom_pr_standard"
              sequence="10"/>
    <menuitem id="menu_cash_pr"
              name="Cash PR"
              parent="menu_purchase_requisition"
              action="action_custom_pr_cash"
              sequence="20"/>
    <!-- Tree View -->
    <record id="view_custom_pr_tree" model="ir.ui.view">
      <field name="name">custom.pr.tree</field>
      <field name="model">custom.pr</field>
      <field name="arch" type="xml">
        <tree string="Purchase Requisitions">
          <field name="name"/>
          <field name="pr_type"/>
          <field name="requested_by"/>
          <field name="date_request"/>
          <field name="approval"/>
          <field name="total_excl_vat"/>
        </tree>
      </field>
    </record>
    <!-- Form View -->
    <record id="view_custom_pr_form" model="ir.ui.view">
      <field name="name">custom.pr.form</field>
      <field name="model">custom.pr</field>
      <field name="arch" type="xml">
        <form string="Purchase Requisition">
          <header>
            <button name="action_create_pr"
            type="object"
            string="Create PR"
            class="btn btn-primary"/>
          </header>
          <sheet>
            <group>
              <group>
                <field name="name" invisible='1'/>
                <field name="pr_type"/>
                <field name="requested_by" readonly='1'/>
                <field name="department" readonly='1'/>
              </group>
              <group>
                <field name="supervisor" readonly='1'/>
                <field name="requested_user_id" invisible='1'/>
                <field name="date_request"/>
                <field name="required_date"/>
                <field name="priority"/>
              </group>
            </group>
            <notebook>
              <page string="Products">
                <field name="line_ids" invisible="not budget_type or not budget_details">
                  <tree editable="bottom">
                    <field name="description"/>
                    <field name="type"/>
                    <field name="unit"/>
                    <field name="quantity"/>
                    <field name="unit_price"/>
                    <field name="total_price" readonly="1"/>
                  </tree>
                </field>
              </page>
              <page string="Budget Information">
                <group>
                  <field name="budget_type"/>
                  <field name="budget_details"/>
                </group>
              </page>
              <page string="Notes">
                <group>
                  <field name="notes"/>
                </group>
              </page>
            </notebook>
            <div class="d-flex text-end justify-content-end gap-2 fs-4">
              <span class="fw-bold"> SubTotal </span>
              <field name="total_excl_vat" readonly="1"/>
            </div>
          </sheet>
        </form>
      </field>
    </record>
  </data>
</odoo>